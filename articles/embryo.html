<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of human embryo • tiltedCCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of human embryo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tiltedCCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tiltedCCA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bm.html">Analysis of CITE-seq</a></li>
    <li><a class="dropdown-item" href="../articles/embryo.html">Analysis of human embryo</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Tilted-CCA Simulation (3 cell types)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of human embryo</h1>
            
      

      <div class="d-none name"><code>embryo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stuart-lab/signac" class="external-link">Signac</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://linnykos.github.io/tiltedCCA/">tiltedCCA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We go through how to analyze single-cell multiomic data in this
vignette (RNA and ATAC). We focus on a 10x Multiome data from <a href="https://pubmed.ncbi.nlm.nih.gov/34390642/" class="external-link">Trevino et al., Cell,
2021</a>, which can be downloaded directly from <a href="https://github.com/GreenleafLab/brainchromatin" class="external-link">their GitHub</a>.
Relevant citation:</p>
<pre><code>Trevino, A. E., Müller, F., Andersen, J., Sundaram, L., Kathiria, A., Shcherbina, A., ... &amp; Greenleaf, W. J. (2021). Chromatin and gene-regulatory dynamics of the developing human cerebral cortex at single-cell resolution. Cell, 184(19), 5053-5069.</code></pre>
<div class="section level2">
<h2 id="preliminary-analysis">Preliminary analysis<a class="anchor" aria-label="anchor" href="#preliminary-analysis"></a>
</h2>
<p>We will work from a simplified preprocessed version of the data,
already compiled as a Seurat object, which you can download from <a href="https://www.dropbox.com/s/gh2om9eb5edgi14/10x_trevino_simplified.RData" class="external-link">https://www.dropbox.com/s/gh2om9eb5edgi14/10x_trevino_simplified.RData</a>
(about 0.34 Gigabytes in size). To make the data more portable,
important biological information (not relevant to our Tilted-CCA
analysis in this vignette) is discarded. Please refer to our <a href="https://github.com/linnykos/tiltedCCA_analysis/blob/master/main/greenleaf_preprocess.R" class="external-link">original
preprocessing script</a> to see how to preprocess the data with the full
biological information.</p>
<div class="section level3">
<h3 id="loading-the-data">Loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h3>
<p>After downloading the file from <a href="https://www.dropbox.com/s/gh2om9eb5edgi14/10x_trevino_simplified.RData" class="external-link">the
Dropbox link</a>, load it into your R session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"10x_trevino_simplified.RData"</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span></span>
<span><span class="co">#&gt; An object of class Seurat </span></span>
<span><span class="co">#&gt; 271643 features across 6158 samples within 2 assays </span></span>
<span><span class="co">#&gt; Active assay: SCT (2027 features, 2027 variable features)</span></span>
<span><span class="co">#&gt;  1 layer present: data</span></span>
<span><span class="co">#&gt;  1 other assay present: ATAC</span></span></code></pre></div>
<p>This data has 6361 cells with 2027 genes and 269616 peaks.</p>
<p>If we look at metadata, we see that the cell types are also provided
(6 cell types in total).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Cyc. Prog.      GluN2      GluN3      GluN4      GluN5 nIPC/GluN1         RG </span></span>
<span><span class="co">#&gt;         341       1546        798        459        223       2348        646</span></span></code></pre></div>
<p>We need now preprocess the data using a typical procedure. While the
data provided in this vignette is already normalized (RNA via
SCTransform, and ATAC via the typical Signac pipeline), we need to
compute the embeddings.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SCT"</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                              dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, </span>
<span>                              reduction.name <span class="op">=</span> <span class="st">"umap.rna"</span>, </span>
<span>                              reduction.key <span class="op">=</span> <span class="st">"rnaUMAP_"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span>  <span class="fu">Signac</span><span class="fu">::</span><span class="fu">RunSVD</span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span>  </span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">seurat_obj</span>,</span>
<span>                              reduction <span class="op">=</span> <span class="st">"lsi"</span>, </span>
<span>                              dims <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">50</span>, </span>
<span>                              reduction.name <span class="op">=</span> <span class="st">"umap.atac"</span>, </span>
<span>                              reduction.key <span class="op">=</span> <span class="st">"atacUMAP_"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/rotate_seurat_embeddings.html">rotate_seurat_embeddings</a></span><span class="op">(</span></span>
<span>  seurat_obj <span class="op">=</span> <span class="va">seurat_obj</span>,</span>
<span>  source_embedding <span class="op">=</span> <span class="st">"umap.rna"</span>,</span>
<span>  target_embedding <span class="op">=</span> <span class="st">"umap.atac"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Cyc. Prog."</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">213</span>, <span class="fl">163</span>, <span class="fl">98</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"GluN2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">122</span>, <span class="fl">179</span>, <span class="fl">232</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"GluN3"</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">174</span>, <span class="fl">198</span>, <span class="fl">235</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"GluN4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">217</span>, <span class="fl">227</span>, <span class="fl">132</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"GluN5"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">127</span>, <span class="fl">175</span>, <span class="fl">123</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"nIPC/GluN1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">114</span>, <span class="fl">169</span>, <span class="fl">158</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span>,</span>
<span>  <span class="st">"RG"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">197</span>, <span class="fl">125</span>, <span class="fl">95</span>, maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                      reduction <span class="op">=</span> <span class="st">"umap.rna"</span>,</span>
<span>                      group.by <span class="op">=</span> <span class="st">"celltype"</span>, </span>
<span>                      cols <span class="op">=</span> <span class="va">col_palette</span>, </span>
<span>                      label <span class="op">=</span> <span class="cn">T</span>, repel <span class="op">=</span> <span class="cn">T</span>, label.size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"RNA"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                      reduction <span class="op">=</span> <span class="st">"umap.atac"</span>,</span>
<span>                      group.by <span class="op">=</span> <span class="st">"celltype"</span>, </span>
<span>                      cols <span class="op">=</span> <span class="va">col_palette</span>, </span>
<span>                      label <span class="op">=</span> <span class="cn">T</span>, repel <span class="op">=</span> <span class="cn">T</span>, label.size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ATAC"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_all</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="embryo_umap.png" alt="UMAPs of the RNA modality (left) and ATAC modality (right)" width="800px"><p class="caption">
UMAPs of the RNA modality (left) and ATAC modality (right)
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="running-tilted-cca">Running Tilted-CCA<a class="anchor" aria-label="anchor" href="#running-tilted-cca"></a>
</h2>
<p>We are now ready to run Tilted-CCA.</p>
<div class="section level3">
<h3 id="extracting-the-relevant-matrices">Extracting the relevant matrices<a class="anchor" aria-label="anchor" href="#extracting-the-relevant-matrices"></a>
</h3>
<p>We now extract the relevant matrices for Tilted-CCA. Since Tilted-CCA
is designed not necessarily for single-cell data, we don’t pass the
Seurat object directly into Tilted-CCA. Instead, we extract the relevant
matrices, where the rows are the cells and the columns are various
features (i.e., genes and antibodies). We also remove features that has
negligible empirical standard deviation. (In this tutorial, no genes or
antibodies were removed in this step.) We end up with
<code>mat_1b</code> that has 30,672 cells and 2000 genes, and
<code>mat_2b</code> that has the same 30,672 cells and 25 surface
antibody markers.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SCT"</span></span>
<span><span class="va">mat_1</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu">t</span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"SCT"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ATAC"</span></span>
<span><span class="va">mat_2</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu">t</span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"ATAC"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat_1b</span> <span class="op">&lt;-</span> <span class="va">mat_1</span></span>
<span><span class="va">sd_vec</span> <span class="op">&lt;-</span> <span class="fu">sparseMatrixStats</span><span class="fu">::</span><span class="fu">colSds</span><span class="op">(</span><span class="va">mat_1b</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">sd_vec</span> <span class="op">&lt;=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mat_1b</span> <span class="op">&lt;-</span> <span class="va">mat_1b</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sd_vec</span> <span class="op">&lt;=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mat_2b</span> <span class="op">&lt;-</span> <span class="va">mat_2</span></span>
<span><span class="va">sd_vec</span> <span class="op">&lt;-</span> <span class="fu">sparseMatrixStats</span><span class="fu">::</span><span class="fu">colSds</span><span class="op">(</span><span class="va">mat_2b</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">sd_vec</span> <span class="op">&lt;=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mat_2b</span> <span class="op">&lt;-</span> <span class="va">mat_2b</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sd_vec</span> <span class="op">&lt;=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-tilted-cca-1">Running Tilted-CCA<a class="anchor" aria-label="anchor" href="#running-tilted-cca-1"></a>
</h3>
<p>We start Tilted-CCA by first preparing all the low-dimensional
embeddings via <code><a href="../reference/create_multiSVD.html">tiltedCCA::create_multiSVD</a></code>. Most of the
boolean arguments are meant to tell our method on whether or not
features are centered and/or scaled (or alternatively, the singular
vectors are centered and/or scaled). We would recommend the boolean
parameters here for any single-cell multiomic data that measures RNA and
antibodies.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">multiSVD_obj</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/create_multiSVD.html">create_multiSVD</a></span><span class="op">(</span>mat_1 <span class="op">=</span> <span class="va">mat_1b</span>, mat_2 <span class="op">=</span> <span class="va">mat_2b</span>,</span>
<span>                                           dims_1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, dims_2 <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>                                           center_1 <span class="op">=</span> <span class="cn">T</span>, center_2 <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                           normalize_row <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                           normalize_singular_value <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                           recenter_1 <span class="op">=</span> <span class="cn">F</span>, recenter_2 <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                           rescale_1 <span class="op">=</span> <span class="cn">F</span>, rescale_2 <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                           scale_1 <span class="op">=</span> <span class="cn">T</span>, scale_2 <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                           verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We then go to the next step of
<code>tiltedCCA:::form_metacells</code>. To make this tutorial be more
portable, we downscale the calculation to only involve 100 metacells.
However, since the UMAPs display a continuous transition of cell states,
we do not need to pass any hard clustering information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiSVD_obj</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/form_metacells.html">form_metacells</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj</span>,</span>
<span>                                          large_clustering_1 <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                          large_clustering_2 <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                          num_metacells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                          verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>This next step, using <code><a href="../reference/compute_snns.html">tiltedCCA::compute_snns</a></code>, is
arguably the most subjective step of Tilted-CCA, but nonetheless can
dramatically impact the results if not chosen with care. Here:</p>
<ul>
<li>
<code>latent_k</code> dictates how many latent dimensions are
extracted from the Laplacian bases of the shared nearest neighbor
graphs</li>
<li>
<code>num_neigh</code> dictates how many nearest neighbors are used
for each cell when constructing the nearest neighbor graphs</li>
<li>
<code>bool_cosine</code> dictates if distance between cells is based
on the cosine distance (if <code>TRUE</code>, i.e., Euclidean distance
after normalizing each gene’s low-dimensional embedding to have
Euclidean length 1) or Euclidean distance (if <code>FALSE</code>)</li>
<li>
<code>bool_intersect</code> dictates if an edge is placed between
two cells only if each cell is a nearest neighbor of the other cell (if
<code>TRUE</code>) or if an edge is placed between two cells as long as
one cell is a nearest neighbor of the other cell (if
<code>FALSE</code>)</li>
<li>
<code>min_deg</code> dictates the smallest number of edges for each
cell (which is only relevant if <code>bool_intersect=TRUE</code>), and
this value should be a value smaller or equal to
<code>num_neigh</code>
</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiSVD_obj</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_snns.html">compute_snns</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj</span>,</span>
<span>                                        latent_k <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                        num_neigh <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                                        bool_cosine <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                        bool_intersect <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                        min_deg <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                                        verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Then, we initialize the tilt for all 49 latent dimensions (i.e., the
minimum between the number of latent dimensions in <code>dims_1</code>
and <code>dims_2</code>) via <code><a href="../reference/tiltedCCA.html">tiltedCCA::tiltedCCA</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiSVD_obj2</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/tiltedCCA.html">tiltedCCA</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj</span>,</span>
<span>                                      verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we fine tune the tilt of each latent dimension. This step
can take a while. On a 2023 Macbook Pro (Sonoma, Apple M2 Max with 32 Gb
of memory), this step takes around 20 minutes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiSVD_obj2</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/fine_tuning.html">fine_tuning</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj2</span>,</span>
<span>                                        verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<details><summary><strong>Results of fine tuning</strong>
</summary><p>The <code>tiltedCCA:::fine_tuning</code> essentially sets the
appropriate tilts per latent dimension, stored in
<code>multiSVD_obj$tcca_obj$tilt_perc</code>. If you want to directly,
you can directly set the desired tilts using the
<code>fix_tilt_perc</code> argument in
<code>tiltedCCA:::fine_tuning</code>. For example, we can run the
following code:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desired_tilt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.85</span>, <span class="fl">0.55</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.95</span>,</span>
<span>                  <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>,</span>
<span>                  <span class="fl">0.40</span>, <span class="fl">0.10</span>, <span class="fl">0.70</span>, <span class="fl">0.15</span>, <span class="fl">0.75</span>, <span class="fl">0.00</span>,</span>
<span>                  <span class="fl">0.00</span>, <span class="fl">0.45</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.80</span>, <span class="fl">0.95</span>,</span>
<span>                  <span class="fl">0.65</span>, <span class="fl">0.40</span>, <span class="fl">0.45</span>, <span class="fl">0.40</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>,</span>
<span>                  <span class="fl">0.80</span>, <span class="fl">0.10</span>, <span class="fl">0.00</span>, <span class="fl">0.30</span>, <span class="fl">0.65</span>, <span class="fl">0.05</span>,</span>
<span>                  <span class="fl">0.65</span>, <span class="fl">0.85</span>, <span class="fl">0.35</span>, <span class="fl">1.00</span>, <span class="fl">0.85</span>, <span class="fl">0.25</span>,</span>
<span>                  <span class="fl">0.90</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.95</span>, <span class="fl">0.30</span>, <span class="fl">0.55</span>,</span>
<span>                  <span class="fl">0.65</span><span class="op">)</span></span>
<span><span class="va">multiSVD_obj3</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/tiltedCCA.html">tiltedCCA</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj</span>,</span>
<span>                                      fix_tilt_perc <span class="op">=</span> <span class="va">desired_tilt</span>,</span>
<span>                                      verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We can then use <code>multiSVD_obj3</code> for the rest of the
tutorial, instead of <code>multiSVD_obj2</code>.</p>
</details><p>After running <code>tiltedCCA:fine_tuning</code>, it is recommended
to save <code>multiSVD_obj2</code> since this was the most expensive
calculation (in terms of computation time). The last function call
simply takes the tilts of each latent dimension to compute the full
decomposition of each modality (i.e., cell by feature matrix), four in
total (i.e., a common and distinct for each RNA and ADT). While this
function doesn’t take too much computation time, it greatly expands the
memory size of the <code>multiSVD_obj2</code> object.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiSVD_obj2</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/tiltedCCA_decomposition.html">tiltedCCA_decomposition</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj2</span>,</span>
<span>                                                    verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                                    bool_modality_1_full <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                                    bool_modality_2_full <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="downstream-analysis-of-tilted-cca">Downstream analysis of Tilted-CCA<a class="anchor" aria-label="anchor" href="#downstream-analysis-of-tilted-cca"></a>
</h2>
<p>Congratulations! You have computed the common and distinct embeddings
for the single-cell multiomic data. There are various downstream
diagnostics you can apply.</p>
<div class="section level3">
<h3 id="visualizing-the-common-and-distinct-embeddings">Visualizing the common and distinct embeddings<a class="anchor" aria-label="anchor" href="#visualizing-the-common-and-distinct-embeddings"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"common_tcca"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/create_SeuratDim.html">create_SeuratDim</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj2</span>,</span>
<span>                                                           what <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                                                           aligned_umap_assay <span class="op">=</span> <span class="st">"rna.umap"</span>,</span>
<span>                                                           seurat_obj <span class="op">=</span> <span class="va">seurat_obj</span>,</span>
<span>                                                           seurat_assay <span class="op">=</span> <span class="st">"SCT"</span>,</span>
<span>                                                           verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"distinct1_tcca"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/create_SeuratDim.html">create_SeuratDim</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj2</span>,</span>
<span>                                                              what <span class="op">=</span> <span class="st">"distinct_1"</span>,</span>
<span>                                                              aligned_umap_assay <span class="op">=</span> <span class="st">"rna.umap"</span>,</span>
<span>                                                              seurat_obj <span class="op">=</span> <span class="va">seurat_obj</span>,</span>
<span>                                                              seurat_assay <span class="op">=</span> <span class="st">"SCT"</span>,</span>
<span>                                                              verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"distinct2_tcca"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tiltedCCA</span><span class="fu">::</span><span class="fu"><a href="../reference/create_SeuratDim.html">create_SeuratDim</a></span><span class="op">(</span>input_obj <span class="op">=</span> <span class="va">multiSVD_obj2</span>,</span>
<span>                                                              what <span class="op">=</span> <span class="st">"distinct_2"</span>,</span>
<span>                                                              aligned_umap_assay <span class="op">=</span> <span class="st">"rna.umap"</span>,</span>
<span>                                                              seurat_obj <span class="op">=</span> <span class="va">seurat_obj</span>,</span>
<span>                                                              seurat_assay <span class="op">=</span> <span class="st">"SCT"</span>,</span>
<span>                                                              verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                      reduction <span class="op">=</span> <span class="st">"common_tcca"</span>,</span>
<span>                      group.by <span class="op">=</span> <span class="st">"celltype"</span>, </span>
<span>                      cols <span class="op">=</span> <span class="va">col_palette</span>, </span>
<span>                      label <span class="op">=</span> <span class="cn">T</span>, repel <span class="op">=</span> <span class="cn">T</span>, label.size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Common"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                      reduction <span class="op">=</span> <span class="st">"distinct1_tcca"</span>,</span>
<span>                      group.by <span class="op">=</span> <span class="st">"celltype"</span>, </span>
<span>                      cols <span class="op">=</span> <span class="va">col_palette</span>, </span>
<span>                      label <span class="op">=</span> <span class="cn">T</span>, repel <span class="op">=</span> <span class="cn">T</span>, label.size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"RNA Distinct"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seurat_obj</span>, </span>
<span>                      reduction <span class="op">=</span> <span class="st">"distinct2_tcca"</span>,</span>
<span>                      group.by <span class="op">=</span> <span class="st">"celltype"</span>, </span>
<span>                      cols <span class="op">=</span> <span class="va">col_palette</span>, </span>
<span>                      label <span class="op">=</span> <span class="cn">T</span>, repel <span class="op">=</span> <span class="cn">T</span>, label.size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ATAC Distinct"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">p_all</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="embryo_tiltedcca.png" alt="Common, RNA distinct, and ATAC distinct embeddings" width="800px"><p class="caption">
Common, RNA distinct, and ATAC distinct embeddings
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Z Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
